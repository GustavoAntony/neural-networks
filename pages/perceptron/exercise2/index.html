<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Gustavo Antony Exercices Delivery"><meta name=author content="Assis, Gustavo-A"><link href=https://gustavoantony.github.io/neural-networks/pages/perceptron/exercise2/ rel=canonical><link href=../exercise1/ rel=prev><link href=../../mlp/mlp/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.18"><title>Perceptron and Not Fully Linearly Separable Data - Gustavo Antony - Artificial Neural Networks and Deep Learning</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.1-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20168c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V192c0-13.3-10.7-24-24-24m26.7%20216a26.7%2026.7%200%201%200-53.3%200%2026.7%2026.7%200%201%200%2053.3%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../../assets/stylesheets/neoteroi-mkdocs.min.css><link rel=stylesheet href=../../../assets/stylesheets/neoteroi-timeline.css><link rel=stylesheet href=../../../assets/stylesheets/extra.css><link rel=stylesheet href=../../../assets/stylesheets/badge.css><link rel=stylesheet href=../../../termynal.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#data-generation-and-visualization class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Gustavo Antony - Artificial Neural Networks and Deep Learning" class="md-header__button md-logo" aria-label="Gustavo Antony - Artificial Neural Networks and Deep Learning" data-md-component=logo> <img src=../../../assets/images/ann-dl.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Gustavo Antony - Artificial Neural Networks and Deep Learning </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Perceptron and Not Fully Linearly Separable Data </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/GustavoAntony/neural-networks.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GustavoAntony/neural-networks </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Gustavo Antony - Artificial Neural Networks and Deep Learning" class="md-nav__button md-logo" aria-label="Gustavo Antony - Artificial Neural Networks and Deep Learning" data-md-component=logo> <img src=../../../assets/images/ann-dl.png alt=logo> </a> Gustavo Antony - Artificial Neural Networks and Deep Learning </label> <div class=md-nav__source> <a href=https://github.com/GustavoAntony/neural-networks.git title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GustavoAntony/neural-networks </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Content </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Content </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> 1. Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> 1. Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../data/exercise1/ class=md-nav__link> <span class=md-ellipsis> Exploring Class Separability in 2D </span> </a> </li> <li class=md-nav__item> <a href=../../data/exercise2/ class=md-nav__link> <span class=md-ellipsis> Non-Linearity in Higher Dimensions </span> </a> </li> <li class=md-nav__item> <a href=../../data/exercise3/ class=md-nav__link> <span class=md-ellipsis> Preparing Real-World Data for a Neural Network </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2 checked> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> 2. Perceptron </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> 2. Perceptron </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../exercise1/ class=md-nav__link> <span class=md-ellipsis> Perceptron and Linearly Separable Data </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Perceptron and Not Fully Linearly Separable Data </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Perceptron and Not Fully Linearly Separable Data </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#data-generation-and-visualization class=md-nav__link> <span class=md-ellipsis> Data generation and visualization </span> </a> </li> <li class=md-nav__item> <a href=#perceptron-implementation class=md-nav__link> <span class=md-ellipsis> Perceptron Implementation </span> </a> <nav class=md-nav aria-label="Perceptron Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accuracy-during-training class=md-nav__link> <span class=md-ellipsis> Accuracy during training </span> </a> </li> <li class=md-nav__item> <a href=#decision-boundary class=md-nav__link> <span class=md-ellipsis> Decision boundary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#final-code class=md-nav__link> <span class=md-ellipsis> Final Code: </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> 3. MLP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> 3. MLP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../mlp/mlp/ class=md-nav__link> <span class=md-ellipsis> MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=../../mlp/exercise1/ class=md-nav__link> <span class=md-ellipsis> Manual Calculation of MLP Steps </span> </a> </li> <li class=md-nav__item> <a href=../../mlp/exercise2/ class=md-nav__link> <span class=md-ellipsis> Binary Classification with Synthetic Data and Scratch MLP </span> </a> </li> <li class=md-nav__item> <a href=../../mlp/exercise3and4/ class=md-nav__link> <span class=md-ellipsis> Multi-Class Classification with Synthetic Data and Reusable MLP </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#data-generation-and-visualization class=md-nav__link> <span class=md-ellipsis> Data generation and visualization </span> </a> </li> <li class=md-nav__item> <a href=#perceptron-implementation class=md-nav__link> <span class=md-ellipsis> Perceptron Implementation </span> </a> <nav class=md-nav aria-label="Perceptron Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accuracy-during-training class=md-nav__link> <span class=md-ellipsis> Accuracy during training </span> </a> </li> <li class=md-nav__item> <a href=#decision-boundary class=md-nav__link> <span class=md-ellipsis> Decision boundary </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#final-code class=md-nav__link> <span class=md-ellipsis> Final Code: </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Perceptron and Not Fully Linearly Separable Data</h1> <h2 id=data-generation-and-visualization>Data generation and visualization</h2> <div class="language-py highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=n>PARAMS_EX2</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>        <span class=mi>0</span> <span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>            <span class=n>MEAN</span> <span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> 
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>            <span class=n>STD</span> <span class=p>:</span> <span class=p>[[</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>]]</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=p>},</span>
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=mi>1</span> <span class=p>:</span> <span class=p>{</span>
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>            <span class=n>MEAN</span> <span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> 
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>            <span class=n>STD</span> <span class=p>:</span> <span class=p>[[</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>]]</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=p>}</span>
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=p>}</span>
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a><span class=k>def</span><span class=w> </span><span class=nf>generate_data</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>n_samples</span> <span class=o>=</span> <span class=mi>1000</span><span class=p>):</span>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=n>X</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>y</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=n>cls_A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>MEAN</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>STD</span><span class=p>],</span> <span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>    <span class=n>cls_B</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>MEAN</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>STD</span><span class=p>],</span> <span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=n>labels_A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=n>labels_B</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>
</span><span id=__span-0-21><a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>cls_A</span><span class=p>,</span> <span class=n>cls_B</span><span class=p>))</span>
</span><span id=__span-0-22><a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>labels_A</span><span class=p>,</span> <span class=n>labels_B</span><span class=p>))</span>
</span><span id=__span-0-23><a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>
</span><span id=__span-0-24><a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>    <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
</span><span id=__span-0-25><a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>
</span><span id=__span-0-26><a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a><span class=k>def</span><span class=w> </span><span class=nf>save_plot_data</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>img_name</span><span class=p>):</span>
</span><span id=__span-0-27><a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'red'</span><span class=p>,</span> <span class=s1>'blue'</span><span class=p>]</span>
</span><span id=__span-0-28><a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>
</span><span id=__span-0-29><a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span><span id=__span-0-30><a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>    <span class=k>for</span> <span class=bp>cls</span> <span class=ow>in</span> <span class=n>params</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span><span id=__span-0-31><a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a>        <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>y</span> <span class=o>==</span> <span class=bp>cls</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>y</span> <span class=o>==</span> <span class=bp>cls</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=bp>cls</span><span class=p>],</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Class </span><span class=si>{</span><span class=bp>cls</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.6</span><span class=p>)</span>
</span><span id=__span-0-32><a href=#__codelineno-0-32 id=__codelineno-0-32 name=__codelineno-0-32></a>
</span><span id=__span-0-33><a href=#__codelineno-0-33 id=__codelineno-0-33 name=__codelineno-0-33></a>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"Label 1"</span><span class=p>)</span>
</span><span id=__span-0-34><a href=#__codelineno-0-34 id=__codelineno-0-34 name=__codelineno-0-34></a>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"Label 2"</span><span class=p>)</span>
</span><span id=__span-0-35><a href=#__codelineno-0-35 id=__codelineno-0-35 name=__codelineno-0-35></a>    <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-0-36><a href=#__codelineno-0-36 id=__codelineno-0-36 name=__codelineno-0-36></a>    <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-0-37><a href=#__codelineno-0-37 id=__codelineno-0-37 name=__codelineno-0-37></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>IMAGES_OUTPUTS_FILE_PATH</span><span class=p>,</span><span class=s1>'perceptron'</span><span class=p>,</span><span class=n>img_name</span><span class=p>))</span>  
</span></code></pre></div> <p>The data consists of two distinct classes, each with 1,000 data points generated from a multivariate normal distribution.</p> <p>The parameters used for this task are designed to create a problem with significant overlap:</p> <p>Higher Variance: A variance of 1.5 causes the data points to be more dispersed.</p> <p>Closer Means: The means of [3, 3] and [4, 4] are close together, bringing the two clusters into close proximity.</p> <p>The combination of higher variance and closer means results in a dataset where the classes mix, making it impossible to separate them with a single straight line. The scatter plot below visually confirms this high degree of overlap.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=../../../assets/images/perceptron/exercise2_1.png><img alt=data src=../../../assets/images/perceptron/exercise2_1.png></a></p> <h2 id=perceptron-implementation>Perceptron Implementation</h2> <div class="language-py highlight"><pre><span></span><code><span id=__span-1-1><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=k>class</span><span class=w> </span><span class=nc>Perceptron</span><span class=p>:</span>
</span><span id=__span-1-2><a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>b</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>max_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>):</span>
</span><span id=__span-1-3><a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tag</span> <span class=o>=</span> <span class=n>tag</span>
</span><span id=__span-1-4><a href=#__codelineno-1-4 id=__codelineno-1-4 name=__codelineno-1-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>max_epochs</span> <span class=o>=</span> <span class=n>max_epochs</span>
</span><span id=__span-1-5><a href=#__codelineno-1-5 id=__codelineno-1-5 name=__codelineno-1-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>learning_rate</span> <span class=o>=</span> <span class=n>learning_rate</span>
</span><span id=__span-1-6><a href=#__codelineno-1-6 id=__codelineno-1-6 name=__codelineno-1-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>w</span> <span class=o>=</span> <span class=n>w</span>
</span><span id=__span-1-7><a href=#__codelineno-1-7 id=__codelineno-1-7 name=__codelineno-1-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>b</span>
</span><span id=__span-1-8><a href=#__codelineno-1-8 id=__codelineno-1-8 name=__codelineno-1-8></a>        <span class=bp>self</span><span class=o>.</span><span class=n>training_accuracies</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-9><a href=#__codelineno-1-9 id=__codelineno-1-9 name=__codelineno-1-9></a>        <span class=bp>self</span><span class=o>.</span><span class=n>predict_function</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span>
</span><span id=__span-1-10><a href=#__codelineno-1-10 id=__codelineno-1-10 name=__codelineno-1-10></a>        <span class=bp>self</span><span class=o>.</span><span class=n>activation_function</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>z</span><span class=p>:</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>z</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span> 
</span><span id=__span-1-11><a href=#__codelineno-1-11 id=__codelineno-1-11 name=__codelineno-1-11></a>
</span><span id=__span-1-12><a href=#__codelineno-1-12 id=__codelineno-1-12 name=__codelineno-1-12></a>    <span class=k>def</span><span class=w> </span><span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-1-13><a href=#__codelineno-1-13 id=__codelineno-1-13 name=__codelineno-1-13></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>predict_function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-1-14><a href=#__codelineno-1-14 id=__codelineno-1-14 name=__codelineno-1-14></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation_function</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-1-15><a href=#__codelineno-1-15 id=__codelineno-1-15 name=__codelineno-1-15></a>
</span><span id=__span-1-16><a href=#__codelineno-1-16 id=__codelineno-1-16 name=__codelineno-1-16></a>    <span class=k>def</span><span class=w> </span><span class=nf>train_epoch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-1-17><a href=#__codelineno-1-17 id=__codelineno-1-17 name=__codelineno-1-17></a>        <span class=n>weights_updated</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-1-18><a href=#__codelineno-1-18 id=__codelineno-1-18 name=__codelineno-1-18></a>        <span class=n>errors_count</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-1-19><a href=#__codelineno-1-19 id=__codelineno-1-19 name=__codelineno-1-19></a>
</span><span id=__span-1-20><a href=#__codelineno-1-20 id=__codelineno-1-20 name=__codelineno-1-20></a>        <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-1-21><a href=#__codelineno-1-21 id=__codelineno-1-21 name=__codelineno-1-21></a>            <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-1-22><a href=#__codelineno-1-22 id=__codelineno-1-22 name=__codelineno-1-22></a>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>classify</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-1-23><a href=#__codelineno-1-23 id=__codelineno-1-23 name=__codelineno-1-23></a>
</span><span id=__span-1-24><a href=#__codelineno-1-24 id=__codelineno-1-24 name=__codelineno-1-24></a>            <span class=n>error</span> <span class=o>=</span> <span class=n>label</span> <span class=o>-</span> <span class=n>result</span>
</span><span id=__span-1-25><a href=#__codelineno-1-25 id=__codelineno-1-25 name=__codelineno-1-25></a>
</span><span id=__span-1-26><a href=#__codelineno-1-26 id=__codelineno-1-26 name=__codelineno-1-26></a>            <span class=k>if</span> <span class=n>error</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-1-27><a href=#__codelineno-1-27 id=__codelineno-1-27 name=__codelineno-1-27></a>                <span class=bp>self</span><span class=o>.</span><span class=n>w</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>learning_rate</span> <span class=o>*</span> <span class=n>error</span> <span class=o>*</span> <span class=n>x</span>
</span><span id=__span-1-28><a href=#__codelineno-1-28 id=__codelineno-1-28 name=__codelineno-1-28></a>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>learning_rate</span> <span class=o>*</span> <span class=n>error</span>
</span><span id=__span-1-29><a href=#__codelineno-1-29 id=__codelineno-1-29 name=__codelineno-1-29></a>                <span class=n>weights_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-1-30><a href=#__codelineno-1-30 id=__codelineno-1-30 name=__codelineno-1-30></a>                <span class=n>errors_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-1-31><a href=#__codelineno-1-31 id=__codelineno-1-31 name=__codelineno-1-31></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Erros na poca: </span><span class=si>{</span><span class=n>errors_count</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-1-32><a href=#__codelineno-1-32 id=__codelineno-1-32 name=__codelineno-1-32></a>        <span class=k>return</span> <span class=n>weights_updated</span>
</span><span id=__span-1-33><a href=#__codelineno-1-33 id=__codelineno-1-33 name=__codelineno-1-33></a>
</span><span id=__span-1-34><a href=#__codelineno-1-34 id=__codelineno-1-34 name=__codelineno-1-34></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-1-35><a href=#__codelineno-1-35 id=__codelineno-1-35 name=__codelineno-1-35></a>        <span class=n>weights_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-1-36><a href=#__codelineno-1-36 id=__codelineno-1-36 name=__codelineno-1-36></a>        <span class=n>current_epoch</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-1-37><a href=#__codelineno-1-37 id=__codelineno-1-37 name=__codelineno-1-37></a>        <span class=n>accuracy_list</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>)]</span>
</span><span id=__span-1-38><a href=#__codelineno-1-38 id=__codelineno-1-38 name=__codelineno-1-38></a>        <span class=n>weights_history</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=o>.</span><span class=n>copy</span><span class=p>()]</span>
</span><span id=__span-1-39><a href=#__codelineno-1-39 id=__codelineno-1-39 name=__codelineno-1-39></a>        <span class=n>bias_history</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>]</span>
</span><span id=__span-1-40><a href=#__codelineno-1-40 id=__codelineno-1-40 name=__codelineno-1-40></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span>
</span><span id=__span-1-41><a href=#__codelineno-1-41 id=__codelineno-1-41 name=__codelineno-1-41></a>        <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
</span><span id=__span-1-42><a href=#__codelineno-1-42 id=__codelineno-1-42 name=__codelineno-1-42></a>        <span class=k>while</span> <span class=n>weights_updated</span> <span class=ow>and</span> <span class=n>current_epoch</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_epochs</span><span class=p>:</span>
</span><span id=__span-1-43><a href=#__codelineno-1-43 id=__codelineno-1-43 name=__codelineno-1-43></a>            <span class=n>weights_updated</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>train_epoch</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>)</span>
</span><span id=__span-1-44><a href=#__codelineno-1-44 id=__codelineno-1-44 name=__codelineno-1-44></a>            <span class=n>acc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>)</span>
</span><span id=__span-1-45><a href=#__codelineno-1-45 id=__codelineno-1-45 name=__codelineno-1-45></a>            <span class=n>accuracy_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>acc</span><span class=p>)</span>
</span><span id=__span-1-46><a href=#__codelineno-1-46 id=__codelineno-1-46 name=__codelineno-1-46></a>            <span class=n>weights_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=o>.</span><span class=n>copy</span><span class=p>())</span>
</span><span id=__span-1-47><a href=#__codelineno-1-47 id=__codelineno-1-47 name=__codelineno-1-47></a>            <span class=n>bias_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-1-48><a href=#__codelineno-1-48 id=__codelineno-1-48 name=__codelineno-1-48></a>            <span class=n>current_epoch</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-1-49><a href=#__codelineno-1-49 id=__codelineno-1-49 name=__codelineno-1-49></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Training finished at epoch </span><span class=si>{</span><span class=n>current_epoch</span><span class=o>-</span><span class=mi>1</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-1-50><a href=#__codelineno-1-50 id=__codelineno-1-50 name=__codelineno-1-50></a>        <span class=n>accuracy_list</span> <span class=o>=</span> <span class=n>accuracy_list</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-51><a href=#__codelineno-1-51 id=__codelineno-1-51 name=__codelineno-1-51></a>        <span class=n>weights_history</span> <span class=o>=</span> <span class=n>weights_history</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-52><a href=#__codelineno-1-52 id=__codelineno-1-52 name=__codelineno-1-52></a>        <span class=n>bias_history</span> <span class=o>=</span> <span class=n>bias_history</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-53><a href=#__codelineno-1-53 id=__codelineno-1-53 name=__codelineno-1-53></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plot_accuracy</span><span class=p>(</span><span class=n>accuracy_list</span><span class=p>)</span>
</span><span id=__span-1-54><a href=#__codelineno-1-54 id=__codelineno-1-54 name=__codelineno-1-54></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plot_decision_boundary</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-1-55><a href=#__codelineno-1-55 id=__codelineno-1-55 name=__codelineno-1-55></a>        <span class=bp>self</span><span class=o>.</span><span class=n>animate_training</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>accuracy_list</span><span class=p>,</span> <span class=n>weights_history</span><span class=p>,</span> <span class=n>bias_history</span><span class=p>)</span>
</span><span id=__span-1-56><a href=#__codelineno-1-56 id=__codelineno-1-56 name=__codelineno-1-56></a>
</span><span id=__span-1-57><a href=#__codelineno-1-57 id=__codelineno-1-57 name=__codelineno-1-57></a>    <span class=k>def</span><span class=w> </span><span class=nf>evaluate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-1-58><a href=#__codelineno-1-58 id=__codelineno-1-58 name=__codelineno-1-58></a>        <span class=n>correct</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-1-59><a href=#__codelineno-1-59 id=__codelineno-1-59 name=__codelineno-1-59></a>        <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-1-60><a href=#__codelineno-1-60 id=__codelineno-1-60 name=__codelineno-1-60></a>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>classify</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-1-61><a href=#__codelineno-1-61 id=__codelineno-1-61 name=__codelineno-1-61></a>            <span class=k>if</span> <span class=n>result</span> <span class=o>==</span> <span class=n>label</span><span class=p>:</span>
</span><span id=__span-1-62><a href=#__codelineno-1-62 id=__codelineno-1-62 name=__codelineno-1-62></a>                <span class=n>correct</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-1-63><a href=#__codelineno-1-63 id=__codelineno-1-63 name=__codelineno-1-63></a>        <span class=n>accuracy</span> <span class=o>=</span> <span class=n>correct</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
</span><span id=__span-1-64><a href=#__codelineno-1-64 id=__codelineno-1-64 name=__codelineno-1-64></a>        <span class=k>if</span> <span class=n>verbose</span><span class=p>:</span>
</span><span id=__span-1-65><a href=#__codelineno-1-65 id=__codelineno-1-65 name=__codelineno-1-65></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Acurcia: </span><span class=si>{</span><span class=n>accuracy</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%"</span><span class=p>)</span>
</span><span id=__span-1-66><a href=#__codelineno-1-66 id=__codelineno-1-66 name=__codelineno-1-66></a>        <span class=k>return</span> <span class=n>accuracy</span>
</span><span id=__span-1-67><a href=#__codelineno-1-67 id=__codelineno-1-67 name=__codelineno-1-67></a>
</span><span id=__span-1-68><a href=#__codelineno-1-68 id=__codelineno-1-68 name=__codelineno-1-68></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_decision_boundary</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span><span id=__span-1-69><a href=#__codelineno-1-69 id=__codelineno-1-69 name=__codelineno-1-69></a>        <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>6</span><span class=p>))</span>
</span><span id=__span-1-70><a href=#__codelineno-1-70 id=__codelineno-1-70 name=__codelineno-1-70></a>        <span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>marker</span><span class=p>,</span> <span class=n>color</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=s1>'o'</span><span class=p>,</span><span class=s1>'s'</span><span class=p>],</span> <span class=p>[</span><span class=s1>'red'</span><span class=p>,</span><span class=s1>'blue'</span><span class=p>]):</span>
</span><span id=__span-1-71><a href=#__codelineno-1-71 id=__codelineno-1-71 name=__codelineno-1-71></a>            <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=n>marker</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Class </span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.6</span><span class=p>)</span>
</span><span id=__span-1-72><a href=#__codelineno-1-72 id=__codelineno-1-72 name=__codelineno-1-72></a>        <span class=n>x_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-1-73><a href=#__codelineno-1-73 id=__codelineno-1-73 name=__codelineno-1-73></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-1-74><a href=#__codelineno-1-74 id=__codelineno-1-74 name=__codelineno-1-74></a>            <span class=n>y_vals</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x_vals</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>)</span><span class=o>/</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-75><a href=#__codelineno-1-75 id=__codelineno-1-75 name=__codelineno-1-75></a>            <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x_vals</span><span class=p>,</span> <span class=n>y_vals</span><span class=p>,</span> <span class=s1>'k--'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Decision Boundary'</span><span class=p>)</span>
</span><span id=__span-1-76><a href=#__codelineno-1-76 id=__codelineno-1-76 name=__codelineno-1-76></a>        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'x1'</span><span class=p>)</span>
</span><span id=__span-1-77><a href=#__codelineno-1-77 id=__codelineno-1-77 name=__codelineno-1-77></a>        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'x2'</span><span class=p>)</span>
</span><span id=__span-1-78><a href=#__codelineno-1-78 id=__codelineno-1-78 name=__codelineno-1-78></a>        <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-1-79><a href=#__codelineno-1-79 id=__codelineno-1-79 name=__codelineno-1-79></a>        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Decision Boundary and Data'</span><span class=p>)</span>
</span><span id=__span-1-80><a href=#__codelineno-1-80 id=__codelineno-1-80 name=__codelineno-1-80></a>        <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-1-81><a href=#__codelineno-1-81 id=__codelineno-1-81 name=__codelineno-1-81></a>        <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>IMAGES_OUTPUTS_FILE_PATH</span><span class=p>,</span> <span class=s1>'perceptron'</span><span class=p>,</span> <span class=sa>f</span><span class=s1>'decision_boundary_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s1>.png'</span><span class=p>))</span>
</span><span id=__span-1-82><a href=#__codelineno-1-82 id=__codelineno-1-82 name=__codelineno-1-82></a>
</span><span id=__span-1-83><a href=#__codelineno-1-83 id=__codelineno-1-83 name=__codelineno-1-83></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_accuracy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>accuracy_list</span><span class=p>):</span>
</span><span id=__span-1-84><a href=#__codelineno-1-84 id=__codelineno-1-84 name=__codelineno-1-84></a>        <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-1-85><a href=#__codelineno-1-85 id=__codelineno-1-85 name=__codelineno-1-85></a>        <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>accuracy_list</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>'o'</span><span class=p>)</span>
</span><span id=__span-1-86><a href=#__codelineno-1-86 id=__codelineno-1-86 name=__codelineno-1-86></a>        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Epoch'</span><span class=p>)</span>
</span><span id=__span-1-87><a href=#__codelineno-1-87 id=__codelineno-1-87 name=__codelineno-1-87></a>        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Accuracy'</span><span class=p>)</span>
</span><span id=__span-1-88><a href=#__codelineno-1-88 id=__codelineno-1-88 name=__codelineno-1-88></a>        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Training Accuracy Over Epochs'</span><span class=p>)</span>
</span><span id=__span-1-89><a href=#__codelineno-1-89 id=__codelineno-1-89 name=__codelineno-1-89></a>        <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-1-90><a href=#__codelineno-1-90 id=__codelineno-1-90 name=__codelineno-1-90></a>        <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>IMAGES_OUTPUTS_FILE_PATH</span><span class=p>,</span> <span class=s1>'perceptron'</span><span class=p>,</span> <span class=sa>f</span><span class=s1>'accuracy_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s1>.png'</span><span class=p>))</span>
</span><span id=__span-1-91><a href=#__codelineno-1-91 id=__codelineno-1-91 name=__codelineno-1-91></a>
</span><span id=__span-1-92><a href=#__codelineno-1-92 id=__codelineno-1-92 name=__codelineno-1-92></a>    <span class=k>def</span><span class=w> </span><span class=nf>animate_training</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>accuracy_list</span><span class=p>,</span> <span class=n>weights_history</span><span class=p>,</span> <span class=n>bias_history</span><span class=p>):</span>
</span><span id=__span-1-93><a href=#__codelineno-1-93 id=__codelineno-1-93 name=__codelineno-1-93></a>        <span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>6</span><span class=p>))</span>
</span><span id=__span-1-94><a href=#__codelineno-1-94 id=__codelineno-1-94 name=__codelineno-1-94></a>        <span class=n>xlim</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-95><a href=#__codelineno-1-95 id=__codelineno-1-95 name=__codelineno-1-95></a>        <span class=n>ylim</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-96><a href=#__codelineno-1-96 id=__codelineno-1-96 name=__codelineno-1-96></a>        <span class=k>def</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>epoch</span><span class=p>):</span>
</span><span id=__span-1-97><a href=#__codelineno-1-97 id=__codelineno-1-97 name=__codelineno-1-97></a>            <span class=n>ax</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span><span id=__span-1-98><a href=#__codelineno-1-98 id=__codelineno-1-98 name=__codelineno-1-98></a>            <span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>marker</span><span class=p>,</span> <span class=n>color</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=s1>'o'</span><span class=p>,</span><span class=s1>'s'</span><span class=p>],</span> <span class=p>[</span><span class=s1>'red'</span><span class=p>,</span><span class=s1>'blue'</span><span class=p>]):</span>
</span><span id=__span-1-99><a href=#__codelineno-1-99 id=__codelineno-1-99 name=__codelineno-1-99></a>                <span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=n>marker</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Class </span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.6</span><span class=p>)</span>
</span><span id=__span-1-100><a href=#__codelineno-1-100 id=__codelineno-1-100 name=__codelineno-1-100></a>            <span class=n>w</span> <span class=o>=</span> <span class=n>weights_history</span><span class=p>[</span><span class=n>epoch</span><span class=p>]</span>
</span><span id=__span-1-101><a href=#__codelineno-1-101 id=__codelineno-1-101 name=__codelineno-1-101></a>            <span class=n>b</span> <span class=o>=</span> <span class=n>bias_history</span><span class=p>[</span><span class=n>epoch</span><span class=p>]</span>
</span><span id=__span-1-102><a href=#__codelineno-1-102 id=__codelineno-1-102 name=__codelineno-1-102></a>            <span class=k>if</span> <span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-1-103><a href=#__codelineno-1-103 id=__codelineno-1-103 name=__codelineno-1-103></a>                <span class=n>x_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>xlim</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>xlim</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-1-104><a href=#__codelineno-1-104 id=__codelineno-1-104 name=__codelineno-1-104></a>                <span class=n>y_vals</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span><span class=n>w</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x_vals</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span><span class=o>/</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-105><a href=#__codelineno-1-105 id=__codelineno-1-105 name=__codelineno-1-105></a>                <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x_vals</span><span class=p>,</span> <span class=n>y_vals</span><span class=p>,</span> <span class=s1>'k--'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Decision Boundary'</span><span class=p>)</span>
</span><span id=__span-1-106><a href=#__codelineno-1-106 id=__codelineno-1-106 name=__codelineno-1-106></a>            <span class=n>misclassified</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-107><a href=#__codelineno-1-107 id=__codelineno-1-107 name=__codelineno-1-107></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>x_point</span><span class=p>,</span> <span class=n>label_point</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)):</span>
</span><span id=__span-1-108><a href=#__codelineno-1-108 id=__codelineno-1-108 name=__codelineno-1-108></a>                <span class=n>pred</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>x_point</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-1-109><a href=#__codelineno-1-109 id=__codelineno-1-109 name=__codelineno-1-109></a>                <span class=k>if</span> <span class=n>pred</span> <span class=o>!=</span> <span class=n>label_point</span><span class=p>:</span>
</span><span id=__span-1-110><a href=#__codelineno-1-110 id=__codelineno-1-110 name=__codelineno-1-110></a>                    <span class=n>misclassified</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span><span id=__span-1-111><a href=#__codelineno-1-111 id=__codelineno-1-111 name=__codelineno-1-111></a>            <span class=k>if</span> <span class=n>misclassified</span><span class=p>:</span>
</span><span id=__span-1-112><a href=#__codelineno-1-112 id=__codelineno-1-112 name=__codelineno-1-112></a>                <span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>misclassified</span><span class=p>,</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>misclassified</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=s1>'yellow'</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>'x'</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Misclassified'</span><span class=p>)</span>
</span><span id=__span-1-113><a href=#__codelineno-1-113 id=__codelineno-1-113 name=__codelineno-1-113></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s1>'Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s1> | Accuracy: </span><span class=si>{</span><span class=n>accuracy_list</span><span class=p>[</span><span class=n>epoch</span><span class=p>]</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>%'</span><span class=p>)</span>
</span><span id=__span-1-114><a href=#__codelineno-1-114 id=__codelineno-1-114 name=__codelineno-1-114></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>'x1'</span><span class=p>)</span>
</span><span id=__span-1-115><a href=#__codelineno-1-115 id=__codelineno-1-115 name=__codelineno-1-115></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>'x2'</span><span class=p>)</span>
</span><span id=__span-1-116><a href=#__codelineno-1-116 id=__codelineno-1-116 name=__codelineno-1-116></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=n>xlim</span><span class=p>)</span>
</span><span id=__span-1-117><a href=#__codelineno-1-117 id=__codelineno-1-117 name=__codelineno-1-117></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=n>ylim</span><span class=p>)</span>
</span><span id=__span-1-118><a href=#__codelineno-1-118 id=__codelineno-1-118 name=__codelineno-1-118></a>            <span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-1-119><a href=#__codelineno-1-119 id=__codelineno-1-119 name=__codelineno-1-119></a>            <span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-1-120><a href=#__codelineno-1-120 id=__codelineno-1-120 name=__codelineno-1-120></a>        <span class=n>anim</span> <span class=o>=</span> <span class=n>FuncAnimation</span><span class=p>(</span><span class=n>fig</span><span class=p>,</span> <span class=n>update</span><span class=p>,</span> <span class=n>frames</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>weights_history</span><span class=p>),</span> <span class=n>interval</span><span class=o>=</span><span class=mi>1500</span><span class=p>)</span>
</span><span id=__span-1-121><a href=#__codelineno-1-121 id=__codelineno-1-121 name=__codelineno-1-121></a>        <span class=n>anim_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>GIFS_OUTPUTS_FILE_PATH</span><span class=p>,</span> <span class=s1>'perceptron'</span><span class=p>,</span> <span class=sa>f</span><span class=s1>'animate_training_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s1>.gif'</span><span class=p>)</span>
</span><span id=__span-1-122><a href=#__codelineno-1-122 id=__codelineno-1-122 name=__codelineno-1-122></a>        <span class=n>anim</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>anim_path</span><span class=p>,</span> <span class=n>writer</span><span class=o>=</span><span class=n>PillowWriter</span><span class=p>(</span><span class=n>fps</span><span class=o>=</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-1-123><a href=#__codelineno-1-123 id=__codelineno-1-123 name=__codelineno-1-123></a>        <span class=n>plt</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></code></pre></div> <h3 id=accuracy-during-training>Accuracy during training</h3> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=../../../assets/images/perceptron/accuracy_ex2.png><img alt=accuracy src=../../../assets/images/perceptron/accuracy_ex2.png></a></p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=../../../assets/gifs/perceptron/animate_training_ex2.gif><img alt="accuracy evolution" src=../../../assets/gifs/perceptron/animate_training_ex2.gif></a></p> <h3 id=decision-boundary>Decision boundary</h3> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=../../../assets/images/perceptron/decision_boundary_ex2.png><img alt=decision_boundary src=../../../assets/images/perceptron/decision_boundary_ex2.png></a></p> <p>On the non linearly separable dataset, the perceptron achieved maximum of 50.05% accuracy, demonstrating difficulty in learning the decision boundary. The model struggled to converge, with weights and bias oscillating without settling. The final decision boundary failed to effectively separate the classes, highlighting the perceptron's limitations on complex datasets. After the maximum epochs, the weights were [0.04358138 0.02465982] and the bias -0.010000000000000753.</p> <p>With this results we can note two main points:</p> <p>The Lack of Convergence: There is no single decision line that can correctly classify all points. Each time the model corrects a misclassified point, it causes another point to become misclassified. This leads to an endless loop of weight updates and a constant oscillation in the model's accuracy. The final non-zero number of errors in the last epoch proves that a perfect solution was not found.</p> <p>Model Limitations: This experiment highlights a core limitation of the single-layer perceptron. For problems with overlapping data, a more complex model, such as a multi-layer neural network with non-linear activation functions, would be required to learn the intricate decision boundaries necessary for accurate classification.</p> <h2 id=final-code>Final Code:</h2> <div class="language-py highlight"><pre><span></span><code><span id=__span-2-1><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-2-2><a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-2-3><a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a><span class=kn>from</span><span class=w> </span><span class=nn>matplotlib.animation</span><span class=w> </span><span class=kn>import</span> <span class=n>FuncAnimation</span><span class=p>,</span> <span class=n>PillowWriter</span>
</span><span id=__span-2-4><a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a><span class=kn>from</span><span class=w> </span><span class=nn>src.utils</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-2-5><a href=#__codelineno-2-5 id=__codelineno-2-5 name=__codelineno-2-5></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
</span><span id=__span-2-6><a href=#__codelineno-2-6 id=__codelineno-2-6 name=__codelineno-2-6></a>
</span><span id=__span-2-7><a href=#__codelineno-2-7 id=__codelineno-2-7 name=__codelineno-2-7></a><span class=k>class</span><span class=w> </span><span class=nc>Perceptron</span><span class=p>:</span>
</span><span id=__span-2-8><a href=#__codelineno-2-8 id=__codelineno-2-8 name=__codelineno-2-8></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tag</span><span class=p>,</span> <span class=n>w</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>b</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>max_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>):</span>
</span><span id=__span-2-9><a href=#__codelineno-2-9 id=__codelineno-2-9 name=__codelineno-2-9></a>        <span class=bp>self</span><span class=o>.</span><span class=n>tag</span> <span class=o>=</span> <span class=n>tag</span>
</span><span id=__span-2-10><a href=#__codelineno-2-10 id=__codelineno-2-10 name=__codelineno-2-10></a>        <span class=bp>self</span><span class=o>.</span><span class=n>max_epochs</span> <span class=o>=</span> <span class=n>max_epochs</span>
</span><span id=__span-2-11><a href=#__codelineno-2-11 id=__codelineno-2-11 name=__codelineno-2-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>learning_rate</span> <span class=o>=</span> <span class=n>learning_rate</span>
</span><span id=__span-2-12><a href=#__codelineno-2-12 id=__codelineno-2-12 name=__codelineno-2-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>w</span> <span class=o>=</span> <span class=n>w</span>
</span><span id=__span-2-13><a href=#__codelineno-2-13 id=__codelineno-2-13 name=__codelineno-2-13></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=n>b</span>
</span><span id=__span-2-14><a href=#__codelineno-2-14 id=__codelineno-2-14 name=__codelineno-2-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>training_accuracies</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-15><a href=#__codelineno-2-15 id=__codelineno-2-15 name=__codelineno-2-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>predict_function</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span>
</span><span id=__span-2-16><a href=#__codelineno-2-16 id=__codelineno-2-16 name=__codelineno-2-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>activation_function</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>z</span><span class=p>:</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>z</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span> 
</span><span id=__span-2-17><a href=#__codelineno-2-17 id=__codelineno-2-17 name=__codelineno-2-17></a>
</span><span id=__span-2-18><a href=#__codelineno-2-18 id=__codelineno-2-18 name=__codelineno-2-18></a>    <span class=k>def</span><span class=w> </span><span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-2-19><a href=#__codelineno-2-19 id=__codelineno-2-19 name=__codelineno-2-19></a>        <span class=n>z</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>predict_function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-2-20><a href=#__codelineno-2-20 id=__codelineno-2-20 name=__codelineno-2-20></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation_function</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-2-21><a href=#__codelineno-2-21 id=__codelineno-2-21 name=__codelineno-2-21></a>
</span><span id=__span-2-22><a href=#__codelineno-2-22 id=__codelineno-2-22 name=__codelineno-2-22></a>    <span class=k>def</span><span class=w> </span><span class=nf>train_epoch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-2-23><a href=#__codelineno-2-23 id=__codelineno-2-23 name=__codelineno-2-23></a>        <span class=n>weights_updated</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-2-24><a href=#__codelineno-2-24 id=__codelineno-2-24 name=__codelineno-2-24></a>        <span class=n>errors_count</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-2-25><a href=#__codelineno-2-25 id=__codelineno-2-25 name=__codelineno-2-25></a>
</span><span id=__span-2-26><a href=#__codelineno-2-26 id=__codelineno-2-26 name=__codelineno-2-26></a>        <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-2-27><a href=#__codelineno-2-27 id=__codelineno-2-27 name=__codelineno-2-27></a>            <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-2-28><a href=#__codelineno-2-28 id=__codelineno-2-28 name=__codelineno-2-28></a>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>classify</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-2-29><a href=#__codelineno-2-29 id=__codelineno-2-29 name=__codelineno-2-29></a>
</span><span id=__span-2-30><a href=#__codelineno-2-30 id=__codelineno-2-30 name=__codelineno-2-30></a>            <span class=n>error</span> <span class=o>=</span> <span class=n>label</span> <span class=o>-</span> <span class=n>result</span>
</span><span id=__span-2-31><a href=#__codelineno-2-31 id=__codelineno-2-31 name=__codelineno-2-31></a>
</span><span id=__span-2-32><a href=#__codelineno-2-32 id=__codelineno-2-32 name=__codelineno-2-32></a>            <span class=k>if</span> <span class=n>error</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-2-33><a href=#__codelineno-2-33 id=__codelineno-2-33 name=__codelineno-2-33></a>                <span class=bp>self</span><span class=o>.</span><span class=n>w</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>learning_rate</span> <span class=o>*</span> <span class=n>error</span> <span class=o>*</span> <span class=n>x</span>
</span><span id=__span-2-34><a href=#__codelineno-2-34 id=__codelineno-2-34 name=__codelineno-2-34></a>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>learning_rate</span> <span class=o>*</span> <span class=n>error</span>
</span><span id=__span-2-35><a href=#__codelineno-2-35 id=__codelineno-2-35 name=__codelineno-2-35></a>                <span class=n>weights_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-2-36><a href=#__codelineno-2-36 id=__codelineno-2-36 name=__codelineno-2-36></a>                <span class=n>errors_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-2-37><a href=#__codelineno-2-37 id=__codelineno-2-37 name=__codelineno-2-37></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Erros na poca: </span><span class=si>{</span><span class=n>errors_count</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-2-38><a href=#__codelineno-2-38 id=__codelineno-2-38 name=__codelineno-2-38></a>        <span class=k>return</span> <span class=n>weights_updated</span>
</span><span id=__span-2-39><a href=#__codelineno-2-39 id=__codelineno-2-39 name=__codelineno-2-39></a>
</span><span id=__span-2-40><a href=#__codelineno-2-40 id=__codelineno-2-40 name=__codelineno-2-40></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-2-41><a href=#__codelineno-2-41 id=__codelineno-2-41 name=__codelineno-2-41></a>        <span class=n>weights_updated</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-2-42><a href=#__codelineno-2-42 id=__codelineno-2-42 name=__codelineno-2-42></a>        <span class=n>current_epoch</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-2-43><a href=#__codelineno-2-43 id=__codelineno-2-43 name=__codelineno-2-43></a>        <span class=n>accuracy_list</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>)]</span>
</span><span id=__span-2-44><a href=#__codelineno-2-44 id=__codelineno-2-44 name=__codelineno-2-44></a>        <span class=n>weights_history</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=o>.</span><span class=n>copy</span><span class=p>()]</span>
</span><span id=__span-2-45><a href=#__codelineno-2-45 id=__codelineno-2-45 name=__codelineno-2-45></a>        <span class=n>bias_history</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>]</span>
</span><span id=__span-2-46><a href=#__codelineno-2-46 id=__codelineno-2-46 name=__codelineno-2-46></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span>
</span><span id=__span-2-47><a href=#__codelineno-2-47 id=__codelineno-2-47 name=__codelineno-2-47></a>        <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
</span><span id=__span-2-48><a href=#__codelineno-2-48 id=__codelineno-2-48 name=__codelineno-2-48></a>        <span class=k>while</span> <span class=n>weights_updated</span> <span class=ow>and</span> <span class=n>current_epoch</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_epochs</span><span class=p>:</span>
</span><span id=__span-2-49><a href=#__codelineno-2-49 id=__codelineno-2-49 name=__codelineno-2-49></a>            <span class=n>weights_updated</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>train_epoch</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>)</span>
</span><span id=__span-2-50><a href=#__codelineno-2-50 id=__codelineno-2-50 name=__codelineno-2-50></a>            <span class=n>acc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>)</span>
</span><span id=__span-2-51><a href=#__codelineno-2-51 id=__codelineno-2-51 name=__codelineno-2-51></a>            <span class=n>accuracy_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>acc</span><span class=p>)</span>
</span><span id=__span-2-52><a href=#__codelineno-2-52 id=__codelineno-2-52 name=__codelineno-2-52></a>            <span class=n>weights_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=o>.</span><span class=n>copy</span><span class=p>())</span>
</span><span id=__span-2-53><a href=#__codelineno-2-53 id=__codelineno-2-53 name=__codelineno-2-53></a>            <span class=n>bias_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-2-54><a href=#__codelineno-2-54 id=__codelineno-2-54 name=__codelineno-2-54></a>            <span class=n>current_epoch</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-2-55><a href=#__codelineno-2-55 id=__codelineno-2-55 name=__codelineno-2-55></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Training finished at epoch </span><span class=si>{</span><span class=n>current_epoch</span><span class=o>-</span><span class=mi>1</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-2-56><a href=#__codelineno-2-56 id=__codelineno-2-56 name=__codelineno-2-56></a>        <span class=n>accuracy_list</span> <span class=o>=</span> <span class=n>accuracy_list</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-2-57><a href=#__codelineno-2-57 id=__codelineno-2-57 name=__codelineno-2-57></a>        <span class=n>weights_history</span> <span class=o>=</span> <span class=n>weights_history</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-2-58><a href=#__codelineno-2-58 id=__codelineno-2-58 name=__codelineno-2-58></a>        <span class=n>bias_history</span> <span class=o>=</span> <span class=n>bias_history</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-2-59><a href=#__codelineno-2-59 id=__codelineno-2-59 name=__codelineno-2-59></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plot_accuracy</span><span class=p>(</span><span class=n>accuracy_list</span><span class=p>)</span>
</span><span id=__span-2-60><a href=#__codelineno-2-60 id=__codelineno-2-60 name=__codelineno-2-60></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plot_decision_boundary</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-2-61><a href=#__codelineno-2-61 id=__codelineno-2-61 name=__codelineno-2-61></a>        <span class=bp>self</span><span class=o>.</span><span class=n>animate_training</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>accuracy_list</span><span class=p>,</span> <span class=n>weights_history</span><span class=p>,</span> <span class=n>bias_history</span><span class=p>)</span>
</span><span id=__span-2-62><a href=#__codelineno-2-62 id=__codelineno-2-62 name=__codelineno-2-62></a>
</span><span id=__span-2-63><a href=#__codelineno-2-63 id=__codelineno-2-63 name=__codelineno-2-63></a>    <span class=k>def</span><span class=w> </span><span class=nf>evaluate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-2-64><a href=#__codelineno-2-64 id=__codelineno-2-64 name=__codelineno-2-64></a>        <span class=n>correct</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-2-65><a href=#__codelineno-2-65 id=__codelineno-2-65 name=__codelineno-2-65></a>        <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>label</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-2-66><a href=#__codelineno-2-66 id=__codelineno-2-66 name=__codelineno-2-66></a>            <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>classify</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-2-67><a href=#__codelineno-2-67 id=__codelineno-2-67 name=__codelineno-2-67></a>            <span class=k>if</span> <span class=n>result</span> <span class=o>==</span> <span class=n>label</span><span class=p>:</span>
</span><span id=__span-2-68><a href=#__codelineno-2-68 id=__codelineno-2-68 name=__codelineno-2-68></a>                <span class=n>correct</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-2-69><a href=#__codelineno-2-69 id=__codelineno-2-69 name=__codelineno-2-69></a>        <span class=n>accuracy</span> <span class=o>=</span> <span class=n>correct</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
</span><span id=__span-2-70><a href=#__codelineno-2-70 id=__codelineno-2-70 name=__codelineno-2-70></a>        <span class=k>if</span> <span class=n>verbose</span><span class=p>:</span>
</span><span id=__span-2-71><a href=#__codelineno-2-71 id=__codelineno-2-71 name=__codelineno-2-71></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Acurcia: </span><span class=si>{</span><span class=n>accuracy</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%"</span><span class=p>)</span>
</span><span id=__span-2-72><a href=#__codelineno-2-72 id=__codelineno-2-72 name=__codelineno-2-72></a>        <span class=k>return</span> <span class=n>accuracy</span>
</span><span id=__span-2-73><a href=#__codelineno-2-73 id=__codelineno-2-73 name=__codelineno-2-73></a>
</span><span id=__span-2-74><a href=#__codelineno-2-74 id=__codelineno-2-74 name=__codelineno-2-74></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_decision_boundary</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span><span id=__span-2-75><a href=#__codelineno-2-75 id=__codelineno-2-75 name=__codelineno-2-75></a>        <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>6</span><span class=p>))</span>
</span><span id=__span-2-76><a href=#__codelineno-2-76 id=__codelineno-2-76 name=__codelineno-2-76></a>        <span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>marker</span><span class=p>,</span> <span class=n>color</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=s1>'o'</span><span class=p>,</span><span class=s1>'s'</span><span class=p>],</span> <span class=p>[</span><span class=s1>'red'</span><span class=p>,</span><span class=s1>'blue'</span><span class=p>]):</span>
</span><span id=__span-2-77><a href=#__codelineno-2-77 id=__codelineno-2-77 name=__codelineno-2-77></a>            <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=n>marker</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Class </span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.6</span><span class=p>)</span>
</span><span id=__span-2-78><a href=#__codelineno-2-78 id=__codelineno-2-78 name=__codelineno-2-78></a>        <span class=n>x_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-2-79><a href=#__codelineno-2-79 id=__codelineno-2-79 name=__codelineno-2-79></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-2-80><a href=#__codelineno-2-80 id=__codelineno-2-80 name=__codelineno-2-80></a>            <span class=n>y_vals</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x_vals</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>)</span><span class=o>/</span><span class=bp>self</span><span class=o>.</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-2-81><a href=#__codelineno-2-81 id=__codelineno-2-81 name=__codelineno-2-81></a>            <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x_vals</span><span class=p>,</span> <span class=n>y_vals</span><span class=p>,</span> <span class=s1>'k--'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Decision Boundary'</span><span class=p>)</span>
</span><span id=__span-2-82><a href=#__codelineno-2-82 id=__codelineno-2-82 name=__codelineno-2-82></a>        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'x1'</span><span class=p>)</span>
</span><span id=__span-2-83><a href=#__codelineno-2-83 id=__codelineno-2-83 name=__codelineno-2-83></a>        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'x2'</span><span class=p>)</span>
</span><span id=__span-2-84><a href=#__codelineno-2-84 id=__codelineno-2-84 name=__codelineno-2-84></a>        <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-2-85><a href=#__codelineno-2-85 id=__codelineno-2-85 name=__codelineno-2-85></a>        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Decision Boundary and Data'</span><span class=p>)</span>
</span><span id=__span-2-86><a href=#__codelineno-2-86 id=__codelineno-2-86 name=__codelineno-2-86></a>        <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-2-87><a href=#__codelineno-2-87 id=__codelineno-2-87 name=__codelineno-2-87></a>        <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>IMAGES_OUTPUTS_FILE_PATH</span><span class=p>,</span> <span class=s1>'perceptron'</span><span class=p>,</span> <span class=sa>f</span><span class=s1>'decision_boundary_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s1>.png'</span><span class=p>))</span>
</span><span id=__span-2-88><a href=#__codelineno-2-88 id=__codelineno-2-88 name=__codelineno-2-88></a>
</span><span id=__span-2-89><a href=#__codelineno-2-89 id=__codelineno-2-89 name=__codelineno-2-89></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_accuracy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>accuracy_list</span><span class=p>):</span>
</span><span id=__span-2-90><a href=#__codelineno-2-90 id=__codelineno-2-90 name=__codelineno-2-90></a>        <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-2-91><a href=#__codelineno-2-91 id=__codelineno-2-91 name=__codelineno-2-91></a>        <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>accuracy_list</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>'o'</span><span class=p>)</span>
</span><span id=__span-2-92><a href=#__codelineno-2-92 id=__codelineno-2-92 name=__codelineno-2-92></a>        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Epoch'</span><span class=p>)</span>
</span><span id=__span-2-93><a href=#__codelineno-2-93 id=__codelineno-2-93 name=__codelineno-2-93></a>        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Accuracy'</span><span class=p>)</span>
</span><span id=__span-2-94><a href=#__codelineno-2-94 id=__codelineno-2-94 name=__codelineno-2-94></a>        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Training Accuracy Over Epochs'</span><span class=p>)</span>
</span><span id=__span-2-95><a href=#__codelineno-2-95 id=__codelineno-2-95 name=__codelineno-2-95></a>        <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-2-96><a href=#__codelineno-2-96 id=__codelineno-2-96 name=__codelineno-2-96></a>        <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>IMAGES_OUTPUTS_FILE_PATH</span><span class=p>,</span> <span class=s1>'perceptron'</span><span class=p>,</span> <span class=sa>f</span><span class=s1>'accuracy_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s1>.png'</span><span class=p>))</span>
</span><span id=__span-2-97><a href=#__codelineno-2-97 id=__codelineno-2-97 name=__codelineno-2-97></a>
</span><span id=__span-2-98><a href=#__codelineno-2-98 id=__codelineno-2-98 name=__codelineno-2-98></a>    <span class=k>def</span><span class=w> </span><span class=nf>animate_training</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>accuracy_list</span><span class=p>,</span> <span class=n>weights_history</span><span class=p>,</span> <span class=n>bias_history</span><span class=p>):</span>
</span><span id=__span-2-99><a href=#__codelineno-2-99 id=__codelineno-2-99 name=__codelineno-2-99></a>        <span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span><span class=mi>6</span><span class=p>))</span>
</span><span id=__span-2-100><a href=#__codelineno-2-100 id=__codelineno-2-100 name=__codelineno-2-100></a>        <span class=n>xlim</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-2-101><a href=#__codelineno-2-101 id=__codelineno-2-101 name=__codelineno-2-101></a>        <span class=n>ylim</span> <span class=o>=</span> <span class=p>(</span><span class=n>X</span><span class=p>[:,</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-2-102><a href=#__codelineno-2-102 id=__codelineno-2-102 name=__codelineno-2-102></a>        <span class=k>def</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>epoch</span><span class=p>):</span>
</span><span id=__span-2-103><a href=#__codelineno-2-103 id=__codelineno-2-103 name=__codelineno-2-103></a>            <span class=n>ax</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span><span id=__span-2-104><a href=#__codelineno-2-104 id=__codelineno-2-104 name=__codelineno-2-104></a>            <span class=k>for</span> <span class=n>label</span><span class=p>,</span> <span class=n>marker</span><span class=p>,</span> <span class=n>color</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=s1>'o'</span><span class=p>,</span><span class=s1>'s'</span><span class=p>],</span> <span class=p>[</span><span class=s1>'red'</span><span class=p>,</span><span class=s1>'blue'</span><span class=p>]):</span>
</span><span id=__span-2-105><a href=#__codelineno-2-105 id=__codelineno-2-105 name=__codelineno-2-105></a>                <span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>label</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=n>marker</span><span class=o>=</span><span class=n>marker</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Class </span><span class=si>{</span><span class=n>label</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.6</span><span class=p>)</span>
</span><span id=__span-2-106><a href=#__codelineno-2-106 id=__codelineno-2-106 name=__codelineno-2-106></a>            <span class=n>w</span> <span class=o>=</span> <span class=n>weights_history</span><span class=p>[</span><span class=n>epoch</span><span class=p>]</span>
</span><span id=__span-2-107><a href=#__codelineno-2-107 id=__codelineno-2-107 name=__codelineno-2-107></a>            <span class=n>b</span> <span class=o>=</span> <span class=n>bias_history</span><span class=p>[</span><span class=n>epoch</span><span class=p>]</span>
</span><span id=__span-2-108><a href=#__codelineno-2-108 id=__codelineno-2-108 name=__codelineno-2-108></a>            <span class=k>if</span> <span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-2-109><a href=#__codelineno-2-109 id=__codelineno-2-109 name=__codelineno-2-109></a>                <span class=n>x_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>xlim</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>xlim</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>100</span><span class=p>)</span>
</span><span id=__span-2-110><a href=#__codelineno-2-110 id=__codelineno-2-110 name=__codelineno-2-110></a>                <span class=n>y_vals</span> <span class=o>=</span> <span class=o>-</span><span class=p>(</span><span class=n>w</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=n>x_vals</span> <span class=o>+</span> <span class=n>b</span><span class=p>)</span><span class=o>/</span><span class=n>w</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-2-111><a href=#__codelineno-2-111 id=__codelineno-2-111 name=__codelineno-2-111></a>                <span class=n>ax</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x_vals</span><span class=p>,</span> <span class=n>y_vals</span><span class=p>,</span> <span class=s1>'k--'</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Decision Boundary'</span><span class=p>)</span>
</span><span id=__span-2-112><a href=#__codelineno-2-112 id=__codelineno-2-112 name=__codelineno-2-112></a>            <span class=n>misclassified</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-113><a href=#__codelineno-2-113 id=__codelineno-2-113 name=__codelineno-2-113></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>x_point</span><span class=p>,</span> <span class=n>label_point</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)):</span>
</span><span id=__span-2-114><a href=#__codelineno-2-114 id=__codelineno-2-114 name=__codelineno-2-114></a>                <span class=n>pred</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>x_point</span><span class=p>)</span> <span class=o>+</span> <span class=n>b</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-2-115><a href=#__codelineno-2-115 id=__codelineno-2-115 name=__codelineno-2-115></a>                <span class=k>if</span> <span class=n>pred</span> <span class=o>!=</span> <span class=n>label_point</span><span class=p>:</span>
</span><span id=__span-2-116><a href=#__codelineno-2-116 id=__codelineno-2-116 name=__codelineno-2-116></a>                    <span class=n>misclassified</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span><span id=__span-2-117><a href=#__codelineno-2-117 id=__codelineno-2-117 name=__codelineno-2-117></a>            <span class=k>if</span> <span class=n>misclassified</span><span class=p>:</span>
</span><span id=__span-2-118><a href=#__codelineno-2-118 id=__codelineno-2-118 name=__codelineno-2-118></a>                <span class=n>ax</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>misclassified</span><span class=p>,</span><span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>misclassified</span><span class=p>,</span><span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=s1>'yellow'</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s1>'x'</span><span class=p>,</span> <span class=n>s</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>'Misclassified'</span><span class=p>)</span>
</span><span id=__span-2-119><a href=#__codelineno-2-119 id=__codelineno-2-119 name=__codelineno-2-119></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s1>'Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s1> | Accuracy: </span><span class=si>{</span><span class=n>accuracy_list</span><span class=p>[</span><span class=n>epoch</span><span class=p>]</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>%'</span><span class=p>)</span>
</span><span id=__span-2-120><a href=#__codelineno-2-120 id=__codelineno-2-120 name=__codelineno-2-120></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s1>'x1'</span><span class=p>)</span>
</span><span id=__span-2-121><a href=#__codelineno-2-121 id=__codelineno-2-121 name=__codelineno-2-121></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s1>'x2'</span><span class=p>)</span>
</span><span id=__span-2-122><a href=#__codelineno-2-122 id=__codelineno-2-122 name=__codelineno-2-122></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_xlim</span><span class=p>(</span><span class=n>xlim</span><span class=p>)</span>
</span><span id=__span-2-123><a href=#__codelineno-2-123 id=__codelineno-2-123 name=__codelineno-2-123></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_ylim</span><span class=p>(</span><span class=n>ylim</span><span class=p>)</span>
</span><span id=__span-2-124><a href=#__codelineno-2-124 id=__codelineno-2-124 name=__codelineno-2-124></a>            <span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-2-125><a href=#__codelineno-2-125 id=__codelineno-2-125 name=__codelineno-2-125></a>            <span class=n>ax</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-2-126><a href=#__codelineno-2-126 id=__codelineno-2-126 name=__codelineno-2-126></a>        <span class=n>anim</span> <span class=o>=</span> <span class=n>FuncAnimation</span><span class=p>(</span><span class=n>fig</span><span class=p>,</span> <span class=n>update</span><span class=p>,</span> <span class=n>frames</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>weights_history</span><span class=p>),</span> <span class=n>interval</span><span class=o>=</span><span class=mi>1500</span><span class=p>)</span>
</span><span id=__span-2-127><a href=#__codelineno-2-127 id=__codelineno-2-127 name=__codelineno-2-127></a>        <span class=n>anim_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>GIFS_OUTPUTS_FILE_PATH</span><span class=p>,</span> <span class=s1>'perceptron'</span><span class=p>,</span> <span class=sa>f</span><span class=s1>'animate_training_</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s1>.gif'</span><span class=p>)</span>
</span><span id=__span-2-128><a href=#__codelineno-2-128 id=__codelineno-2-128 name=__codelineno-2-128></a>        <span class=n>anim</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>anim_path</span><span class=p>,</span> <span class=n>writer</span><span class=o>=</span><span class=n>PillowWriter</span><span class=p>(</span><span class=n>fps</span><span class=o>=</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-2-129><a href=#__codelineno-2-129 id=__codelineno-2-129 name=__codelineno-2-129></a>        <span class=n>plt</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span><span id=__span-2-130><a href=#__codelineno-2-130 id=__codelineno-2-130 name=__codelineno-2-130></a>
</span><span id=__span-2-131><a href=#__codelineno-2-131 id=__codelineno-2-131 name=__codelineno-2-131></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-2-132><a href=#__codelineno-2-132 id=__codelineno-2-132 name=__codelineno-2-132></a><span class=kn>from</span><span class=w> </span><span class=nn>src.utils</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-2-133><a href=#__codelineno-2-133 id=__codelineno-2-133 name=__codelineno-2-133></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-2-134><a href=#__codelineno-2-134 id=__codelineno-2-134 name=__codelineno-2-134></a><span class=kn>from</span><span class=w> </span><span class=nn>src.perceptron.perceptron</span><span class=w> </span><span class=kn>import</span> <span class=n>Perceptron</span>
</span><span id=__span-2-135><a href=#__codelineno-2-135 id=__codelineno-2-135 name=__codelineno-2-135></a>
</span><span id=__span-2-136><a href=#__codelineno-2-136 id=__codelineno-2-136 name=__codelineno-2-136></a><span class=n>PARAMS_EX2</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-2-137><a href=#__codelineno-2-137 id=__codelineno-2-137 name=__codelineno-2-137></a>        <span class=mi>0</span> <span class=p>:</span> <span class=p>{</span>
</span><span id=__span-2-138><a href=#__codelineno-2-138 id=__codelineno-2-138 name=__codelineno-2-138></a>            <span class=n>MEAN</span> <span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> 
</span><span id=__span-2-139><a href=#__codelineno-2-139 id=__codelineno-2-139 name=__codelineno-2-139></a>            <span class=n>STD</span> <span class=p>:</span> <span class=p>[[</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>]]</span>
</span><span id=__span-2-140><a href=#__codelineno-2-140 id=__codelineno-2-140 name=__codelineno-2-140></a>        <span class=p>},</span>
</span><span id=__span-2-141><a href=#__codelineno-2-141 id=__codelineno-2-141 name=__codelineno-2-141></a>        <span class=mi>1</span> <span class=p>:</span> <span class=p>{</span>
</span><span id=__span-2-142><a href=#__codelineno-2-142 id=__codelineno-2-142 name=__codelineno-2-142></a>            <span class=n>MEAN</span> <span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> 
</span><span id=__span-2-143><a href=#__codelineno-2-143 id=__codelineno-2-143 name=__codelineno-2-143></a>            <span class=n>STD</span> <span class=p>:</span> <span class=p>[[</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>]]</span>
</span><span id=__span-2-144><a href=#__codelineno-2-144 id=__codelineno-2-144 name=__codelineno-2-144></a>        <span class=p>}</span>
</span><span id=__span-2-145><a href=#__codelineno-2-145 id=__codelineno-2-145 name=__codelineno-2-145></a>    <span class=p>}</span>
</span><span id=__span-2-146><a href=#__codelineno-2-146 id=__codelineno-2-146 name=__codelineno-2-146></a>
</span><span id=__span-2-147><a href=#__codelineno-2-147 id=__codelineno-2-147 name=__codelineno-2-147></a><span class=k>def</span><span class=w> </span><span class=nf>generate_data</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>n_samples</span> <span class=o>=</span> <span class=mi>1000</span><span class=p>):</span>
</span><span id=__span-2-148><a href=#__codelineno-2-148 id=__codelineno-2-148 name=__codelineno-2-148></a>    <span class=n>X</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-149><a href=#__codelineno-2-149 id=__codelineno-2-149 name=__codelineno-2-149></a>    <span class=n>y</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-150><a href=#__codelineno-2-150 id=__codelineno-2-150 name=__codelineno-2-150></a>
</span><span id=__span-2-151><a href=#__codelineno-2-151 id=__codelineno-2-151 name=__codelineno-2-151></a>    <span class=n>cls_A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>MEAN</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>STD</span><span class=p>],</span> <span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-2-152><a href=#__codelineno-2-152 id=__codelineno-2-152 name=__codelineno-2-152></a>    <span class=n>cls_B</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>multivariate_normal</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>MEAN</span><span class=p>],</span> <span class=n>params</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>STD</span><span class=p>],</span> <span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-2-153><a href=#__codelineno-2-153 id=__codelineno-2-153 name=__codelineno-2-153></a>    <span class=n>labels_A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-2-154><a href=#__codelineno-2-154 id=__codelineno-2-154 name=__codelineno-2-154></a>    <span class=n>labels_B</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>n_samples</span><span class=p>)</span>
</span><span id=__span-2-155><a href=#__codelineno-2-155 id=__codelineno-2-155 name=__codelineno-2-155></a>
</span><span id=__span-2-156><a href=#__codelineno-2-156 id=__codelineno-2-156 name=__codelineno-2-156></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>cls_A</span><span class=p>,</span> <span class=n>cls_B</span><span class=p>))</span>
</span><span id=__span-2-157><a href=#__codelineno-2-157 id=__codelineno-2-157 name=__codelineno-2-157></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>labels_A</span><span class=p>,</span> <span class=n>labels_B</span><span class=p>))</span>
</span><span id=__span-2-158><a href=#__codelineno-2-158 id=__codelineno-2-158 name=__codelineno-2-158></a>
</span><span id=__span-2-159><a href=#__codelineno-2-159 id=__codelineno-2-159 name=__codelineno-2-159></a>    <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
</span><span id=__span-2-160><a href=#__codelineno-2-160 id=__codelineno-2-160 name=__codelineno-2-160></a>
</span><span id=__span-2-161><a href=#__codelineno-2-161 id=__codelineno-2-161 name=__codelineno-2-161></a><span class=k>def</span><span class=w> </span><span class=nf>save_plot_data</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>img_name</span><span class=p>):</span>
</span><span id=__span-2-162><a href=#__codelineno-2-162 id=__codelineno-2-162 name=__codelineno-2-162></a>    <span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'red'</span><span class=p>,</span> <span class=s1>'blue'</span><span class=p>]</span>
</span><span id=__span-2-163><a href=#__codelineno-2-163 id=__codelineno-2-163 name=__codelineno-2-163></a>
</span><span id=__span-2-164><a href=#__codelineno-2-164 id=__codelineno-2-164 name=__codelineno-2-164></a>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span><span id=__span-2-165><a href=#__codelineno-2-165 id=__codelineno-2-165 name=__codelineno-2-165></a>    <span class=k>for</span> <span class=bp>cls</span> <span class=ow>in</span> <span class=n>params</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span><span id=__span-2-166><a href=#__codelineno-2-166 id=__codelineno-2-166 name=__codelineno-2-166></a>        <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>y</span> <span class=o>==</span> <span class=bp>cls</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>y</span> <span class=o>==</span> <span class=bp>cls</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>colors</span><span class=p>[</span><span class=bp>cls</span><span class=p>],</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Class </span><span class=si>{</span><span class=bp>cls</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.6</span><span class=p>)</span>
</span><span id=__span-2-167><a href=#__codelineno-2-167 id=__codelineno-2-167 name=__codelineno-2-167></a>
</span><span id=__span-2-168><a href=#__codelineno-2-168 id=__codelineno-2-168 name=__codelineno-2-168></a>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"Label 1"</span><span class=p>)</span>
</span><span id=__span-2-169><a href=#__codelineno-2-169 id=__codelineno-2-169 name=__codelineno-2-169></a>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"Label 2"</span><span class=p>)</span>
</span><span id=__span-2-170><a href=#__codelineno-2-170 id=__codelineno-2-170 name=__codelineno-2-170></a>    <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span><span id=__span-2-171><a href=#__codelineno-2-171 id=__codelineno-2-171 name=__codelineno-2-171></a>    <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-2-172><a href=#__codelineno-2-172 id=__codelineno-2-172 name=__codelineno-2-172></a>    <span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>IMAGES_OUTPUTS_FILE_PATH</span><span class=p>,</span><span class=s1>'perceptron'</span><span class=p>,</span><span class=n>img_name</span><span class=p>))</span>  
</span><span id=__span-2-173><a href=#__codelineno-2-173 id=__codelineno-2-173 name=__codelineno-2-173></a>
</span><span id=__span-2-174><a href=#__codelineno-2-174 id=__codelineno-2-174 name=__codelineno-2-174></a><span class=k>def</span><span class=w> </span><span class=nf>exercise2</span><span class=p>():</span>
</span><span id=__span-2-175><a href=#__codelineno-2-175 id=__codelineno-2-175 name=__codelineno-2-175></a>    <span class=n>X2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>generate_data</span><span class=p>(</span><span class=n>params</span><span class=o>=</span><span class=n>PARAMS_EX2</span><span class=p>,</span> <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
</span><span id=__span-2-176><a href=#__codelineno-2-176 id=__codelineno-2-176 name=__codelineno-2-176></a>    <span class=n>save_plot_data</span><span class=p>(</span><span class=n>X2</span><span class=p>,</span> <span class=n>y2</span><span class=p>,</span> <span class=n>PARAMS_EX2</span><span class=p>,</span> <span class=s1>'exercise2_1.png'</span><span class=p>)</span>
</span><span id=__span-2-177><a href=#__codelineno-2-177 id=__codelineno-2-177 name=__codelineno-2-177></a>    <span class=n>perceptron</span> <span class=o>=</span> <span class=n>Perceptron</span><span class=p>(</span><span class=s1>'ex2'</span><span class=p>)</span>
</span><span id=__span-2-178><a href=#__codelineno-2-178 id=__codelineno-2-178 name=__codelineno-2-178></a>    <span class=n>perceptron</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X2</span><span class=p>,</span><span class=n>y2</span><span class=p>)</span>
</span><span id=__span-2-179><a href=#__codelineno-2-179 id=__codelineno-2-179 name=__codelineno-2-179></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>'Final training weights: </span><span class=si>{</span><span class=n>perceptron</span><span class=o>.</span><span class=n>w</span><span class=si>}</span><span class=s1>, and Bias: </span><span class=si>{</span><span class=n>perceptron</span><span class=o>.</span><span class=n>b</span><span class=si>}</span><span class=s1>'</span><span class=p>)</span>
</span><span id=__span-2-180><a href=#__codelineno-2-180 id=__codelineno-2-180 name=__codelineno-2-180></a>
</span><span id=__span-2-181><a href=#__codelineno-2-181 id=__codelineno-2-181 name=__codelineno-2-181></a><span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-2-182><a href=#__codelineno-2-182 id=__codelineno-2-182 name=__codelineno-2-182></a>    <span class=n>exercise2</span><span class=p>()</span>
</span><span id=__span-2-183><a href=#__codelineno-2-183 id=__codelineno-2-183 name=__codelineno-2-183></a>
</span><span id=__span-2-184><a href=#__codelineno-2-184 id=__codelineno-2-184 name=__codelineno-2-184></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>"__main__"</span><span class=p>:</span>
</span><span id=__span-2-185><a href=#__codelineno-2-185 id=__codelineno-2-185 name=__codelineno-2-185></a>    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-2-186><a href=#__codelineno-2-186 id=__codelineno-2-186 name=__codelineno-2-186></a>    <span class=n>main</span><span class=p>()</span>
</span></code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.92b07e13.min.js></script> <script src=../../../assets/_markdown_exec_pyodide.js></script> <script src=../../../assets/javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../assets/javascripts/badge.js async></script> <script src=../../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>